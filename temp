Yes — **you can use `sanitizeFilenamePreserveExtension()` everywhere you are sanitizing a *full filename* (something that already has `.xml/.pdf/.csv/...`)**.

But don’t use it for values that are **not full filenames**, like:

* party name (`"HUÎTRIÈRE & EOLE"`)
* supplier name
* invoice id (sometimes you want to keep dots)
* bucket / contract / registry keys

For those, you should sanitize as a **token**, not as a filename-with-extension.

### Rule of thumb

* ✅ **Full filename** (has extension): use `sanitizeFilenamePreserveExtension("abc...pdf")`
* ✅ **Folder name / token** (no extension): use `sanitizeToken("HUÎTRIÈRE & EOLE")`

### Why it matters

If you pass `"HUÎTRIÈRE & EOLE"` into `sanitizeFilenamePreserveExtension()`:

* it has **no extension**, so it sanitizes the entire string (fine)
* but if the value contains dots (like `26.51.510012`) it will treat the last dot like an “extension separator” and may keep the tail as an “extension”, which is **not what you want for IDs**.

So the clean minimal setup is:

```java
String safeParty = sanitizeToken(partyName);              // token
String safeId    = sanitizeToken(invoiceId);              // token (or a special “keep dots” version)
String safeFile  = sanitizeFilenamePreserveExtension(fileName); // filename
```

If you want, paste 2–3 examples of your **invoiceId formats** (dot vs underscore expectations), and I’ll give you the exact `sanitizeInvoiceId()` that:

* keeps dots *or* converts them (your choice),
* and ensures the invoiceId appears **only once at the end** of the output filename.
