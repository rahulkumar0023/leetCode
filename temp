// 3 Pre-validate entry name
if (entryName == null || entryName.trim().isEmpty()) {
    continue;
}
if (entryName.contains("..") || entryName.startsWith("/") || entryName.startsWith("\\")) {
    throw new IOException("Unsafe ZIP entry name: " + entryName);
}

// 4 Canonical path validation (safe version)
Path targetPath = baseDir.toPath().resolve(entryName).normalize();
if (!targetPath.startsWith(baseDir.toPath())) {
    throw new IOException("Entry is outside target dir: " + entryName);
}

// âœ… Only now create file
File outFile = targetPath.toFile();

// 5 If entry is a directory
if (entry.isDirectory()) {
    Files.createDirectories(outFile.toPath());
    continue;
}
