            // ✅ Uses system default truststore (production safe)
            SSLContext sslContext = SSLContexts.createSystemDefault();

            // ✅ Modern TLS strategy (no deprecated classes)
            var tlsStrategy = ClientTlsStrategyBuilder.create()
                    .setSslContext(sslContext)
                    .setHostnameVerifier(new DefaultHostnameVerifier()) // strict host check
                    .build();

            // ✅ Connection manager using current API
            PoolingHttpClientConnectionManager connectionManager =
                    PoolingHttpClientConnectionManagerBuilder.create()
                            .setTlsStrategy(tlsStrategy)
                            .build();

            // ✅ Build the HttpClient
            return HttpClients.custom()
                    .setConnectionManager(connectionManager)
                    .evictExpiredConnections()
                    .evictIdleConnections(Timeout.ofSeconds(30))
                    .build();
