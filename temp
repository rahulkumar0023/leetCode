Yep — I can see exactly where the issue comes from in your `updateInvoiceName(...)`:

```java
supplierParty.replace(" ", "-")
...
invoiceFileName.replace("/", "-")
```

That only fixes **spaces** and **forward slashes**, but supplier names can contain lots of other filename-breaking characters (and multiple whitespaces).

## Minimal, clean fix in `XmlInvoiceWriter`

### 1) Add a small sanitizer (keep it local, Sonar/Fortify safe)

Add these imports:

```java
import java.util.regex.Pattern;
```

Add this near the bottom of the class:

```java
private static final Pattern UNSAFE_FILE_CHARS = Pattern.compile("[\\s\\\\/:*?\"<>|]+");

private String sanitizeForFileName(String value) {
    if (value == null) {
        return "unknown";
    }
    String trimmed = value.trim();
    if (trimmed.isEmpty()) {
        return "unknown";
    }
    return UNSAFE_FILE_CHARS.matcher(trimmed).replaceAll("_");
}
```

* Replaces **whitespace** + **/ \ : * ? " < > |** with `_`
* Collapses repeated unsafe chars into a single `_`
* Avoids weird folder creation
* Pattern is **precompiled** (Sonar-friendly)

---

### 2) Use it in your finance filename block (minimal change)

Replace this part:

```java
String supplierParty = invoiceBucketResolver.getSupplierName(invoice.getAccountingSupplierParty());
invoiceFileName = getCurrentDateTimeValue() + "_" +
        supplierParty.replace(" ", "-") +
        "_INV_" + invoiceFileName.replace("/", "-") + ".xml";
```

With this:

```java
String supplierPartyRaw = invoiceBucketResolver.getSupplierName(invoice.getAccountingSupplierParty());
String supplierParty = sanitizeForFileName(supplierPartyRaw);

String invoicePart = sanitizeForFileName(invoiceFileName);

invoiceFileName = getCurrentDateTimeValue() + "_" +
        supplierParty +
        "_INV_" + invoicePart + ".xml";
```

That’s it. You don’t need to touch the rest of the writer.

---

## Why this fixes your issue

* Supplier name like `ACME / Finance GmbH` becomes `ACME_Finance_GmbH`
* Invoice IDs containing `/` (common!) become safe too
* Works across Linux/Windows and avoids accidental directory nesting

---

If you want, paste the rest of `updateInvoiceName(...)` and I’ll show the final full method with only these minimal edits applied (no refactor).

