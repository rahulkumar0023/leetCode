@Test
void testGetOutputPathThrowsWhenEntryEscapesTargetDir() throws Exception {
    ZipArchiveEntry entry = new ZipArchiveEntry("../escape.txt");
    Path base = Files.createTempDirectory("unzipped");

    InvoiceProcessingException ex = assertThrows(
            InvoiceProcessingException.class,
            () -> SafeApacheExtractor.getOutputPath(entry, base)
    );

    assertTrue(ex.getMessage().contains("escapes target directory"));
}
